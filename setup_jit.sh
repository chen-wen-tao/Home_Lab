#!/usr/bin/env bash
# JIT Access Setup Instructions
# Provides instructions for enabling Just-in-Time access for all lab VMs

RG_NAME="lab-complete-rg"

echo "ğŸ”’ JIT Access Setup Instructions"
echo "================================"
echo ""
echo "JIT (Just-in-Time) access must be configured through the Azure Portal."
echo "Here's how to enable it for your lab VMs:"
echo ""
echo "ğŸ“‹ Step-by-Step Instructions:"
echo ""
echo "1. ğŸŒ Go to Azure Portal (portal.azure.com)"
echo "2. ğŸ” Search for 'Security Center' or 'Microsoft Defender for Cloud'"
echo "3. ğŸ“Š Navigate to 'Just-in-time VM access'"
echo "4. âš™ï¸  Click 'Configure'"
echo ""
echo "5. ğŸ–¥ï¸  For each VM, configure the following:"
echo ""
echo "   ğŸ“Œ Domain Controller (dc):"
echo "   - Port: 3389 (RDP)"
echo "   - Max request time: 8 hours"
echo "   - Source IPs: 0.0.0.0/0 (or your specific IP)"
echo ""
echo "   ğŸ“Œ Windows Client (client):"
echo "   - Port: 3389 (RDP)"
echo "   - Max request time: 8 hours"
echo "   - Source IPs: 0.0.0.0/0 (or your specific IP)"
echo ""
echo "   ğŸ“Œ Linux Client (linux-client):"
echo "   - Port: 22 (SSH)"
echo "   - Max request time: 8 hours"
echo "   - Source IPs: 0.0.0.0/0 (or your specific IP)"
echo ""
echo "   ğŸ“Œ Jumpbox (jumpbox):"
echo "   - Port: 3389 (RDP)"
echo "   - Max request time: 8 hours"
echo "   - Source IPs: 0.0.0.0/0 (or your specific IP)"
echo ""
echo "6. âœ… Save the configuration"
echo ""
echo "ğŸ” How to use JIT access once configured:"
echo "1. Go to Security Center â†’ Just-in-time VM access"
echo "2. Select the VM you want to access"
echo "3. Click 'Request access' for the port you need"
echo "4. Access will be granted for the configured time"
echo "5. After the time limit, access is automatically revoked"
echo ""
echo "ğŸ’¡ Benefits of JIT access:"
echo "   - Temporarily opens specific ports only when needed"
echo "   - Requires approval for access"
echo "   - Automatically closes ports after time limit"
echo "   - Logs all access attempts for security auditing"
echo "   - Reduces attack surface by keeping ports closed by default"
echo ""
echo "ğŸ”— Direct link to JIT access:"
echo "https://portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/JustInTime"
